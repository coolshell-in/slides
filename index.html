<!DOCTYPE html>
<html>
<head>
    <title>Slides</title>
    <style>
        .nav-links {
            margin: 20px;
        }
        .nav-links a {
            margin-right: 15px;
            padding: 8px 16px;
            text-decoration: none;
            background: #f0f0f0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="nav-links">
        <a href="house">House</a>
        <a href="study">Study</a>
        <a href="god">God</a>
    </div>

    <div id="content"> SLIDES by Atom.X</div>  <!-- Initial content -->

    <script>
        function loadContent(subdir, innerPage = 'what.html') {
            fetch(`${subdir}/${innerPage}`)
                .then(response => response.text())
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const content = doc.getElementById('content').innerHTML;

                    document.getElementById('content').innerHTML = content;

                    const scripts = doc.querySelectorAll('script');
                    scripts.forEach(script => {
                        const newScript = document.createElement('script');
                        newScript.textContent = script.textContent;
                        document.getElementById('content').appendChild(newScript);
                    });

                    // Update URL after content loads (important for refresh to work)
                    window.history.pushState({}, '', `/${subdir}`); // For initial load and subdir navigation
                    if (innerPage !== 'what.html') { // Add hash for inner pages
                        window.history.pushState({}, '', `/${subdir}#${innerPage.replace('.html', '')}`);
                    }
                })
                .catch(error => {
                    console.error("Error loading content:", error); // Log the error for debugging
                    document.getElementById('content').innerHTML = 'Content not available';
                });
        }

        function getCurrentSubdir() {
            const path = window.location.pathname;
            const parts = path.split('/').filter(part => part !== '');
            return parts.length > 0 ? parts[0] : 'house'; // Default to 'house' if path is just '/'
        }

        // Get the initial subdirectory from the URL
        const initialSubdir = getCurrentSubdir();

        // Load the default 'what.html' for the initial subdirectory

        if (window.location.pathname === '/') { // Only load if at the root path
            loadContent(initialSubdir);
        }


        // Event listener for link clicks (explicitly pass 'what.html')
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const targetSubdir = link.getAttribute('href');
                loadContent(targetSubdir, 'what.html');  // Explicitly pass 'what.html'
                window.history.pushState({}, '', `/${targetSubdir}`);
            });
        });

        // Handle back/forward button clicks
        window.addEventListener('popstate', () => {
            const currentSubdir = getCurrentSubdir();
            loadContent(currentSubdir); // 'what.html' will be the default innerPage
        });

    </script>
</body>
</html>